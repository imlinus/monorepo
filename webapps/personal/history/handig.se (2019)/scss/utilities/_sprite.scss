/* USAGE
----------------------------------------------------------------------
  you need 3 folders:
    - sprites
    - sprites-retina;
    - generated
then

@import 'sprites';
.like{
    @include sprite(like)
}
.class{
    @include sprite(fileNameWithoutExtension)
}

*/

/* IMPORTS
---------------------------------------------------------------------- */

@import "compass/utilities/sprites";
@import "compass/css3/background-size";

/* MIXIN
---------------------------------------------------------------------- */

$generated_sprites_folder : "generated/";
$sprites: sprite-map("sprites/*.png", $spacing: 10px );
$sprites-retina: sprite-map("sprites-retina/*.png", $spacing: 10px );

// https://gist.github.com/thulstrup/2140082#comment-378557
@mixin sprite($name){
  @include retina-sprite($name, $sprites, $sprites-retina)
}

@mixin retina-sprite($name, $prites, $sprites-retina){
  background-image:sprite-url($sprites);
  background-position: sprite-position($sprites, $name);
  background-repeat: no-repeat;
  @include sprite-dimensions($sprites, $name);
  @media (-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-device-pixel-ratio: 1.5){
    &{
      $pos: sprite-position($sprites-retina, $name);
      background-image: sprite-url($sprites-retina);
      background-position: nth($pos, 1) nth($pos, 2)/2;
      // @include sprite-dimensions($sprites-retina, $name);
      @include background-size(ceil(image-width($generated_sprites_folder + sprite-path($sprites-retina)) / 2), auto);
    }
  }
}
